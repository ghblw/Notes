

###单模式串匹配

#### 暴力

优化：利用模式串信息



####KMP

母串指针为什么不会回退？

因为，前缀后缀匹配l位，跳k位，l + k = n - 1

只需要找到判断模式串和当前字符能否匹配的新位置

求next数组：模式串自我匹配



####SUNDAY算法

黄金对齐点

最快O(n/m)?

在一篇文章中找一个单词是否出现过，整个单词会直接跳过特殊字符如空格等



####Shift And算法

用一个整形代表字符在模式串中出现的位置，给一个整形，可以利用位运算来判断某个字符出没出现过

一般按照模式串左到右，为二进制数从低到高的位

状态码P记录了多种状态，nfa思维模型简化。

新进来第三位字符，第三位匹配成功的条件

- **前一个状态(字符)匹配成功前两位**，之前的第二位必须是１

  左移一位（将第二位移动到第三位），|1(边界处理假设第-1位已经匹配成功)
- **当前字符在第三位出现过**

递推公式：$P = (P << 1 | 1) $ & $d[s[i]] $

O(n)

优点：模式串被整理成状态码，与原模式串无关，例如一个字符位可以匹配多个字符，见正则表达式例题。

O(n * m / K) K:基础数据类型可以表示多少位二进制



思考：

只支持３２位模式串，	改成可以处理任意长度的模式串，改p

整形是３２位的数据结构



### 字典树



**结构定义**

- 红白节点，是否独立成词，flag = 1为红节点
- next指针数组

**节点初始化**

- 初始化为白节点

**插入字符串**

- 不存在节点则调用初始化
- 在单词结尾节点设为红节点

**查询字符串**

- 类似插入操作，不存在节点则返回false
- 遍历字符串字符结束后，返回是否是红白节点

**注意**

- 字符指针代表边而不是节点

中序遍历是字典序？

洛谷１４８１

####双数组字典树

字典树转化成双数组字典树

工程上：所有单词排序，容易得到根结点下子结点个数，递归，第一位，第二位

###多模式串匹配

####暴力

对比单模

字典树指针回溯到头	模式串回溯到头

KMP找最长后缀

####AC自动机

**失败指针(等价匹配指针)**

到了某个节点失配后到哪去找

例：匹配成功she等价于匹配成功he

**如何建立失败指针**

蓝色节点向哪跳？

逐层建立

先看父节点的fail指针,例如指向根节点，而根节点下方有这个字符的边，说明可以接在根节点下方的节点。（类比next数组的+ 1）

如果没有这条字符的边，那么顺着失败指针再向上找

第二层指向根节点（代表没有字符可匹配）	(类比next[0] = -1)

 其 他指向根节点的层（代表匹配成功当前节点等价于匹配成功根节点，字典树指针要回溯到根节点）



**流式处理**

40TB文本串，统计出现了多少单词

每次只需一个字符，进一个字符，跳一个状态

**实现**

传统意义上的数据结构大多从根节点开始，从父节点到子节点，而AC自动机更类似图

遍历：**队列**（树的层序遍历）

以前，求树高：深度遍历（**栈**），先处理完子节点，然后再回到父节点

**四个部分**

队列＋字典树插入＋建AC自动机（求fail指针）＋匹配

**注意**

- 字典树根结点非空，根结点的fail指针指向NULL，根结点的flag = 0，统计时的逻辑顺序等
- 队列结构定义：存的是结点的地址

####神仙题：计蒜客：疑似病毒

可达矩阵

矩阵的k次方

矩阵快速幂



双数组字典树加一个数组存fail指针

作业：计蒜客，线索化

一堆单词，拼字符串，只能出现26个字母，最短串为多少可以找到没有出现的单词

查找字典树最浅哪一层不满

一堆单词，能不能找到一个长度为n的字符串，这个字符串不包含任何单词集合中的单词

根结点走n步回到根结点，说明存在单词，删掉独立成词的节点，可达矩阵的n次方不是全0矩阵